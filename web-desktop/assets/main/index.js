System.register("chunks:///_virtual/debug-view-runtime-control.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,n,s,l,r,a,g,h,p,c,C,d,m,u,L;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,l=t._decorator,r=t.Node,a=t.Color,g=t.Canvas,h=t.UITransform,p=t.instantiate,c=t.Label,C=t.RichText,d=t.Toggle,m=t.Button,u=t.director,L=t.Component}],execute:function(){var f,M,b,v,T,S,x,E,I;s._RF.push({},"b2bd1+njXxJxaFY3ymm06WU","debug-view-runtime-control",void 0);var A=l.ccclass,y=l.property;t("DebugViewRuntimeControl",(f=A("internal.DebugViewRuntimeControl"),M=y(r),b=y(r),v=y(r),f((x=e((S=function(t){function e(){for(var e,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return e=t.call.apply(t,[this].concat(s))||this,i(e,"compositeModeToggle",x,n(e)),i(e,"singleModeToggle",E,n(e)),i(e,"EnableAllCompositeModeButton",I,n(e)),e._single=0,e.strSingle=["No Single Debug","Vertex Color","Vertex Normal","Vertex Tangent","World Position","Vertex Mirror","Face Side","UV0","UV1","UV Lightmap","Project Depth","Linear Depth","Fragment Normal","Fragment Tangent","Fragment Binormal","Base Color","Diffuse Color","Specular Color","Transparency","Metallic","Roughness","Specular Intensity","IOR","Direct Diffuse","Direct Specular","Direct All","Env Diffuse","Env Specular","Env All","Emissive","Light Map","Shadow","AO","Fresnel","Direct Transmit Diffuse","Direct Transmit Specular","Env Transmit Diffuse","Env Transmit Specular","Transmit All","Direct Internal Specular","Env Internal Specular","Internal All","Fog"],e.strComposite=["Direct Diffuse","Direct Specular","Env Diffuse","Env Specular","Emissive","Light Map","Shadow","AO","Normal Map","Fog","Tone Mapping","Gamma Correction","Fresnel","Transmit Diffuse","Transmit Specular","Internal Specular","TT"],e.strMisc=["CSM Layer Coloration","Lighting With Albedo"],e.compositeModeToggleList=[],e.singleModeToggleList=[],e.miscModeToggleList=[],e.textComponentList=[],e.labelComponentList=[],e.textContentList=[],e.hideButtonLabel=void 0,e._currentColorIndex=0,e.strColor=["<color=#ffffff>","<color=#000000>","<color=#ff0000>","<color=#00ff00>","<color=#0000ff>"],e.color=[a.WHITE,a.BLACK,a.RED,a.GREEN,a.BLUE],e}o(e,t);var s=e.prototype;return s.start=function(){if(this.node.parent.getComponent(g)){var t=this.node.parent.getComponent(h),e=.5*t.width,o=.5*t.height,i=.1*e-e,n=o-.1*o,s=this.node.getChildByName("MiscMode"),l=p(s);l.parent=this.node,l.name="Buttons";var r=p(s);r.parent=this.node,r.name="Titles";for(var u=0;u<2;u++){var L=p(this.EnableAllCompositeModeButton.getChildByName("Label"));L.setPosition(i+(u>0?450:150),n,0),L.setScale(.75,.75,.75),L.parent=r;var f=L.getComponent(c);f.string=u?"----------Composite Mode----------":"----------Single Mode----------",f.color=a.WHITE,f.overflow=0,this.labelComponentList[this.labelComponentList.length]=f}n-=20;for(var M=0,b=0;b<this.strSingle.length;b++,M++){b===this.strSingle.length>>1&&(i+=200,M=0);var v=b?p(this.singleModeToggle):this.singleModeToggle;v.setPosition(i,n-20*M,0),v.setScale(.5,.5,.5),v.parent=this.singleModeToggle.parent;var T=v.getComponentInChildren(C);T.string=this.strSingle[b],this.textComponentList[this.textComponentList.length]=T,this.textContentList[this.textContentList.length]=T.string,v.on(d.EventType.TOGGLE,this.toggleSingleMode,this),this.singleModeToggleList[b]=v}i+=200,this.EnableAllCompositeModeButton.setPosition(i+15,n,0),this.EnableAllCompositeModeButton.setScale(.5,.5,.5),this.EnableAllCompositeModeButton.on(m.EventType.CLICK,this.enableAllCompositeMode,this),this.EnableAllCompositeModeButton.parent=l;var S=this.EnableAllCompositeModeButton.getComponentInChildren(c);this.labelComponentList[this.labelComponentList.length]=S;var x=p(this.EnableAllCompositeModeButton);x.setPosition(i+90,n,0),x.setScale(.5,.5,.5),x.on(m.EventType.CLICK,this.changeTextColor,this),x.parent=l,(S=x.getComponentInChildren(c)).string="TextColor",this.labelComponentList[this.labelComponentList.length]=S;var E=p(this.EnableAllCompositeModeButton);E.setPosition(i+200,n,0),E.setScale(.5,.5,.5),E.on(m.EventType.CLICK,this.hideUI,this),E.parent=this.node.parent,(S=E.getComponentInChildren(c)).string="Hide UI",this.labelComponentList[this.labelComponentList.length]=S,this.hideButtonLabel=S,n-=40;for(var I=0;I<this.strMisc.length;I++){var A=p(this.compositeModeToggle);A.setPosition(i,n-20*I,0),A.setScale(.5,.5,.5),A.parent=s;var y=A.getComponentInChildren(C);y.string=this.strMisc[I],this.textComponentList[this.textComponentList.length]=y,this.textContentList[this.textContentList.length]=y.string,A.getComponent(d).isChecked=!!I,A.on(d.EventType.TOGGLE,I?this.toggleLightingWithAlbedo:this.toggleCSMColoration,this),this.miscModeToggleList[I]=A}n-=150;for(var D=0;D<this.strComposite.length;D++){var B=D?p(this.compositeModeToggle):this.compositeModeToggle;B.setPosition(i,n-20*D,0),B.setScale(.5,.5,.5),B.parent=this.compositeModeToggle.parent;var w=B.getComponentInChildren(C);w.string=this.strComposite[D],this.textComponentList[this.textComponentList.length]=w,this.textContentList[this.textContentList.length]=w.string,B.on(d.EventType.TOGGLE,this.toggleCompositeMode,this),this.compositeModeToggleList[D]=B}}else console.error("debug-view-runtime-control should be child of Canvas")},s.isTextMatched=function(t,e){var o=new String(t),i=o.search(">");return-1===i?t===e:(o=(o=o.substr(i+1)).substr(0,o.search("<")))===e},s.toggleSingleMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strSingle.length;i++)this.isTextMatched(o.string,this.strSingle[i])&&(e.singleMode=i)},s.toggleCompositeMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strComposite.length;i++)this.isTextMatched(o.string,this.strComposite[i])&&e.enableCompositeMode(i,t.isChecked)},s.toggleLightingWithAlbedo=function(t){u.root.debugView.lightingWithAlbedo=t.isChecked},s.toggleCSMColoration=function(t){u.root.debugView.csmLayerColoration=t.isChecked},s.enableAllCompositeMode=function(t){var e=u.root.debugView;e.enableAllCompositeMode(!0);for(var o=0;o<this.compositeModeToggleList.length;o++){this.compositeModeToggleList[o].getComponent(d).isChecked=!0}var i=this.miscModeToggleList[0].getComponent(d);i.isChecked=!1,e.csmLayerColoration=!1,(i=this.miscModeToggleList[1].getComponent(d)).isChecked=!0,e.lightingWithAlbedo=!0},s.hideUI=function(t){var e=this.node.getChildByName("Titles"),o=!e.active;this.singleModeToggleList[0].parent.active=o,this.miscModeToggleList[0].parent.active=o,this.compositeModeToggleList[0].parent.active=o,this.EnableAllCompositeModeButton.parent.active=o,e.active=o,this.hideButtonLabel.string=o?"Hide UI":"Show UI"},s.changeTextColor=function(t){this._currentColorIndex++,this._currentColorIndex>=this.strColor.length&&(this._currentColorIndex=0);for(var e=0;e<this.textComponentList.length;e++)this.textComponentList[e].string=this.strColor[this._currentColorIndex]+this.textContentList[e]+"</color>";for(var o=0;o<this.labelComponentList.length;o++)this.labelComponentList[o].color=this.color[this._currentColorIndex]},s.onLoad=function(){},s.update=function(t){},e}(L)).prototype,"compositeModeToggle",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(S.prototype,"singleModeToggle",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(S.prototype,"EnableAllCompositeModeButton",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=S))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/FloatEffect.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,c,n;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,c=t._decorator,n=t.Component}],execute:function(){var r;o._RF.push({},"020e2WhTxdM945Cc7AD8BsF","FloatEffect",void 0);var u=c.ccclass;c.property,t("FloatEffect",u("FloatEffect")(r=function(t){function o(){return t.apply(this,arguments)||this}e(o,t);var c=o.prototype;return c.start=function(){},c.update=function(t){},o}(n))||r);o._RF.pop()}}}));

System.register("chunks:///_virtual/GameConfig.ts",["cc"],(function(e){var n;return{setters:[function(e){n=e.cclegacy}],execute:function(){n._RF.push({},"3bfabSVJcFKsIBfV7TzwB8y","GameConfig",void 0);var c=e("GameConfig",(function(){}));c.URL="ws://124.221.249.36:3000/",c.MAP_W=8,c.MAP_H=8,c.isHolder=!1,n._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SocketManager.ts","./MapManager.ts","./GameConfig.ts","./TipManager.ts"],(function(e){var n,t,i,a,r,o,l,s,u,c,p,h,g,f,d,y;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,a=e.assertThisInitialized},function(e){r=e.cclegacy,o=e._decorator,l=e.Node,s=e.Label,u=e.tween,c=e.v3,p=e.director,h=e.Component},function(e){g=e.SocketManager},function(e){f=e.MapManager},function(e){d=e.GameConfig},function(e){y=e.TipManager}],execute:function(){var b,m,T,w,P,v,L,B,M,z,E,S,C,R,H,I,_,F,G,D,U,W,k,O,A,x,N,j,q,J,K,Q,V,X;r._RF.push({},"6c28f9dekBCRbkMsWf65a09","GameManager",void 0);var Y=o.ccclass,Z=o.property;e("GameManager",(b=Y("GameManager"),m=Z(l),T=Z(l),w=Z(l),P=Z(l),v=Z(l),L=Z(l),B=Z(l),M=Z(l),z=Z(Boolean),E=Z(Boolean),S=Z(Boolean),C=Z(Boolean),R=Z(s),H=Z(l),I=Z(l),b(((X=function(e){function n(){for(var n,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return n=e.call.apply(e,[this].concat(r))||this,i(n,"title",G,a(n)),i(n,"shipPanel",D,a(n)),i(n,"playerLayoutPanel",U,a(n)),i(n,"enemyLayout",W,a(n)),i(n,"operationPanel",k,a(n)),i(n,"FireButton",O,a(n)),i(n,"SearchButton",A,a(n)),i(n,"ReadyButton",x,a(n)),i(n,"isHolder",N,a(n)),i(n,"gameTurn",j,a(n)),i(n,"isPrepared",q,a(n)),i(n,"isEnd",J,a(n)),i(n,"TurnLabel",K,a(n)),i(n,"WinPanel",Q,a(n)),i(n,"LosePanel",V,a(n)),n}t(n,e);var r=n.prototype;return r.onLoad=function(){n.instance=this,this.registerUI()},r.canInteract=function(){return!this.isPrepared||this.isEnd},r.registerUI=function(){var e=this;this.ReadyButton.on(l.EventType.TOUCH_START,(function(n){if(f.instance.countPlayer()<15)y.instance.showTip("请部署所有船只");else if(e.isPrepared){e.isPrepared=!1;var t={action:"unready",map:f.instance.gridFlags,shipInfo:f.instance.collectShipInfo()};g.send(t),e.ReadyButton.getComponentInChildren(s).string="准备"}else{e.isPrepared=!0;var i={action:"ready",map:f.instance.gridFlags,shipInfo:f.instance.collectShipInfo()};g.send(i),e.ReadyButton.getComponentInChildren(s).string="取消"}}),this),this.FireButton.on(l.EventType.TOUCH_START,(function(n){if(e.gameTurn){var t=f.instance.selectedEnemyGridIndex();if(-1!=t){f.instance.fireEnemy(t),e.DoTurn();g.send({action:"remote_turn"})}else y.instance.showTip("请选择位置目标"),console.log("not select enemy grid")}else y.instance.showTip("等待对方操作")}),this),this.SearchButton.on(l.EventType.TOUCH_START,(function(n){if(e.gameTurn){var t=f.instance.selectedEnemyGridIndex();if(-1!=t){f.instance.searchEnemy(t),e.DoTurn();g.send({action:"remote_turn"})}else y.instance.showTip("请选择位置目标"),console.log("not select enemy grid")}else y.instance.showTip("等待对方操作")}),this)},r.start=function(){},r.update=function(e){},r.startGame=function(e){var n=this;this.title.getComponent(s).string="选择位置炮击/侦察！",this.isHolder=d.isHolder,this.isHolder?f.instance.enemyFlags=e.guestMap:f.instance.enemyFlags=e.holderMap,u(this.shipPanel).to(.5,{position:c(0,-500,0)}).start(),u(this.playerLayoutPanel).to(.5,{position:c(-100,-350,0),scale:c(.5,.5,1)}).start(),u(this.enemyLayout).to(.5,{position:c(0,200,0)}).start(),u(this.operationPanel).to(.5,{position:c(300,-350,0)}).start(),u(this.ReadyButton).to(.5,{position:c(450,550,0)}).start(),this.gameTurn=this.isHolder,u(this.node).to(1,{}).call((function(){n.gameTurn?(y.instance.showTip("你的回合"),n.TurnLabel.string="你的\n回合"):(y.instance.showTip("对方回合"),n.TurnLabel.string="对方\n回合")})).start()},r.Win=function(){this.isEnd=!0,this.WinPanel.active=!0;g.send({action:"remote_win"}),this.WinPanel.on(l.EventType.TOUCH_END,(function(e){p.loadScene("MenuScene")}),this)},r.Lose=function(){this.isEnd=!0,this.LosePanel.active=!0,this.WinPanel.on(l.EventType.TOUCH_END,(function(e){p.loadScene("MenuScene")}),this)},r.DoTurn=function(){this.gameTurn?(this.gameTurn=!1,this.TurnLabel.string="对方\n回合"):console.warn("非法！")},r.RecoverTurn=function(){this.gameTurn||(this.gameTurn=!0,this.TurnLabel.string="你的回合")},n}(h)).instance=void 0,G=n((F=X).prototype,"title",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=n(F.prototype,"shipPanel",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=n(F.prototype,"playerLayoutPanel",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=n(F.prototype,"enemyLayout",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=n(F.prototype,"operationPanel",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=n(F.prototype,"FireButton",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=n(F.prototype,"SearchButton",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=n(F.prototype,"ReadyButton",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=n(F.prototype,"isHolder",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),j=n(F.prototype,"gameTurn",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),q=n(F.prototype,"isPrepared",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),J=n(F.prototype,"isEnd",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),K=n(F.prototype,"TurnLabel",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q=n(F.prototype,"WinPanel",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=n(F.prototype,"LosePanel",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=F))||_));r._RF.pop()}}}));

System.register("chunks:///_virtual/GridController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MapManager.ts","./GameConfig.ts","./GridEffectController.ts"],(function(e){var t,n,r,i,o,a,c,f,u,l,s,p,d,h;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,c=e.Node,f=e.UITransform,u=e.Vec3,l=e.Vec2,s=e.Component},function(e){p=e.MapManager},function(e){d=e.GameConfig},function(e){h=e.GridEffectController}],execute:function(){var y,g,m,C,b,G,v,x,E,M;o._RF.push({},"facdaCD7j9C2aqxq2AhsfyO","GridController",void 0);var P=a.ccclass,S=a.property;e("GridController",(y=P("GridController"),g=S(p),m=S(c),y((G=t((b=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,r(t,"x",G,i(t)),r(t,"y",v,i(t)),r(t,"mapManager",x,i(t)),r(t,"isEnemy",E,i(t)),r(t,"GridEffect",M,i(t)),t}n(t,e);var o=t.prototype;return o.setPos=function(e){var t=Math.floor(e/d.MAP_W),n=e%d.MAP_W;this.x=n,this.y=t},o.getIndex=function(){return this.x+this.y*d.MAP_W},o.inGrid=function(e){var t=this.truePos(),n=this.trueWH(),r=n.x/2,i=n.y/2;return e.x>t.x-r&&e.x<t.x+r&&e.y>t.y-i&&e.y<t.y+i},o.truePos=function(){return this.node.getComponent(f).convertToWorldSpaceAR(u.ZERO)},o.trueWH=function(){for(var e=this.node.getComponent(f),t=e.width,n=e.height,r=this.node;r;){var i=r.getScale();t*=i.x,n*=i.y,r=r.parent}return new l(t,n)},o.bindShip=function(e){e.setWorldPosition(this.truePos())},o.registerEnemyButton=function(){var e=this;this.node.on(c.EventType.TOUCH_START,(function(t){e.mapManager.selectEnemyGrid(e.node)}),this)},o.effectSelect=function(e,t){this.GridEffect.getComponent(h).effectSelect(e,t)},o.effectState=function(e,t){this.GridEffect.getComponent(h).effectState(e,t)},o.effectCount=function(e,t){this.GridEffect.getComponent(h).effectCount(e,t)},t}(s)).prototype,"x",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),v=t(b.prototype,"y",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),x=t(b.prototype,"mapManager",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=t(b.prototype,"isEnemy",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),M=t(b.prototype,"GridEffect",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=b))||C));o._RF.pop()}}}));

System.register("chunks:///_virtual/GridEffectController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MapManager.ts"],(function(t){var e,r,n,i,o,a,c,l,s,u,p,f,M;return{setters:[function(t){e=t.applyDecoratedDescriptor,r=t.inheritsLoose,n=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){o=t.cclegacy,a=t._decorator,c=t.Node,l=t.Label,s=t.UITransform,u=t.Vec3,p=t.Component},function(t){f=t.MapManager,M=t.GridState}],execute:function(){var d,h,k,m,y,b,v,C,g,S,z;o._RF.push({},"bc975IOAGRFkKCBQG5foTz6","GridEffectController",void 0);var E=a.ccclass,R=a.property;t("GridEffectController",(d=E("GridEffectController"),h=R(c),k=R(c),m=R(c),y=R(l),d((C=e((v=function(t){function e(){for(var e,r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,n(e,"Aim",C,i(e)),n(e,"EmptyMark",g,i(e)),n(e,"FiredMark",S,i(e)),n(e,"CountMark",z,i(e)),e}r(e,t);var o=e.prototype;return o.effectSelect=function(t,e){this.Aim.active=t,this.setParent(this.Aim,f.instance.MarkRoot,e)},o.start=function(){},o.effectState=function(t,e){switch(t){case M.Empty:this.EmptyMark.active=!0,this.setParent(this.EmptyMark,f.instance.MarkRoot,e);break;case M.Fired:this.FiredMark.active=!0,this.setParent(this.FiredMark,f.instance.MarkRoot,e)}},o.effectCount=function(t,e){this.CountMark.node.active=!0,this.CountMark.string=t.toString(),this.setParent(this.CountMark.node,f.instance.MarkRoot,e)},o.setParent=function(t,e,r){var n,i=t.getComponent(s),o=t.scale.clone(),a=i.contentSize.clone(),c=i.convertToWorldSpaceAR(new u(0,0,0));t.parent=e;var l=null==(n=e.getComponent(s))?void 0:n.convertToNodeSpaceAR(c);t.setPosition(l),r?t.setScale(new u(o.x*o.x,o.y*o.y,1)):t.setScale(o),t.getComponent(s).setContentSize(a)},e}(p)).prototype,"Aim",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=e(v.prototype,"EmptyMark",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=e(v.prototype,"FiredMark",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=e(v.prototype,"CountMark",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=v))||b));o._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./debug-view-runtime-control.ts","./FloatEffect.ts","./GameConfig.ts","./GameManager.ts","./GridController.ts","./GridEffectController.ts","./MapManager.ts","./MenuSceneManager.ts","./MultiWaitSceneManager.ts","./ShipBoxController.ts","./ShipController.ts","./ShipManager.ts","./SocketManager.ts","./TipController.ts","./TipManager.ts","./TestDrag.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MapManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GridController.ts","./GameConfig.ts","./SocketManager.ts","./TipManager.ts","./GameManager.ts"],(function(e){var t,n,i,r,o,a,s,l,c,u,m,y,d,h,f;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,s=e.Node,l=e.CCBoolean,c=e.Sprite,u=e.Component},function(e){m=e.GridController},function(e){y=e.GameConfig},function(e){d=e.SocketManager},function(e){h=e.TipManager},function(e){f=e.GameManager}],execute:function(){var p,g,G,b,E,C,S,w,M,v,F,z,I,P,_,k,x,A,T,R,D,U,W,B,L,H,j;o._RF.push({},"047b4wxIptCdZxVzP8vyieJ","MapManager",void 0);var J=a.ccclass,N=a.property,V=e("GridState",function(e){return e[e.Unknown=0]="Unknown",e[e.Empty=1]="Empty",e[e.Fired=2]="Fired",e[e.Destroyed=3]="Destroyed",e}({}));e("MapManager",(p=J("MapManager"),g=N(s),G=N(s),b=N(s),E=N(s),C=N([l]),S=N([l]),w=N(s),M=N(s),p(((j=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,i(t,"playerGridsRoot",z,r(t)),i(t,"enemyGridsRoot",I,r(t)),i(t,"playerGrids",P,r(t)),i(t,"enemyGrids",_,r(t)),i(t,"gridFlags",k,r(t)),i(t,"enemyFlags",x,r(t)),i(t,"gridStates",A,r(t)),i(t,"enemyStates",T,r(t)),i(t,"gridSearches",R,r(t)),i(t,"enemySearches",D,r(t)),t.shipInfo={},i(t,"enemyEmptyCount",U,r(t)),i(t,"enemyFiredCount",W,r(t)),i(t,"enemySearchCount",B,r(t)),i(t,"selectedEnemyGrid",L,r(t)),i(t,"MarkRoot",H,r(t)),t}n(t,e);var o=t.prototype;return o.selectedEnemyGridIndex=function(){return this.selectedEnemyGrid?this.selectedEnemyGrid.getComponent(m).getIndex():-1},o.onLoad=function(){t.instance=this,this.loadPlayerGrids(),this.loadEnemyGrids(),this.gridFlags=new Array(64).fill(!1),this.gridStates=new Array(64).fill(V.Unknown),this.enemyStates=new Array(64).fill(V.Unknown),this.gridSearches=new Array(64).fill(-1),this.enemySearches=new Array(64).fill(-1)},o.loadPlayerGrids=function(){var e=this,t=0;this.playerGridsRoot.children.forEach((function(n){var i=n.getComponent(m);i.setPos(t),i.mapManager=e,t++,e.playerGrids.push(n)}))},o.loadEnemyGrids=function(){var e=this,t=0;this.enemyGridsRoot.children.forEach((function(n){var i=n.getComponent(m);i.setPos(t),i.mapManager=e,i.isEnemy=!0,i.registerEnemyButton(),t++,e.enemyGrids.push(n)}))},o.checkPos=function(e){for(var t=0;t<this.playerGrids.length;t++)if(this.playerGrids[t].getComponent(m).inGrid(e))return t;return-1},o.checkShapeCollision=function(e,t){for(var n=t.getIndexes(e),i=0;i<n.length;i++)if(this.gridFlags[n[i]])return!0;return!1},o.recordShapeCollision=function(e,t,n){void 0===n&&(n=!0);for(var i=t.getIndexes(e),r=0;r<i.length;r++)this.gridFlags[i[r]]=n;this.shipInfo[t.shipType]=i},o.start=function(){},o.update=function(e){for(var t=0;t<this.enemyGrids.length;t++){this.enemyGrids[t].getComponent(c);this.enemyGrids[t],this.selectedEnemyGrid}},o.fireEnemy=function(e){return this.enemyStates[e]==V.Unknown?(this.enemyFlags[e]?(this.enemyStates[e]=V.Fired,console.log("fired at "+e),this.showTargetEffect(V.Fired),this.enemyFiredCount=this.enemyFiredCount+1,this.enemyFiredCount>=this.countEnemy()?(h.instance.showTip("全歼敌人！"),f.instance.Win()):h.instance.showTip("击中敌人！")):(this.enemyStates[e]=V.Empty,console.log("empty at "+e),this.showTargetEffect(V.Empty),this.enemyEmptyCount=this.enemyEmptyCount+1,h.instance.showTip("打空了！")),!0):(console.log("has fired"),!1)},o.countEnemy=function(){for(var e=0,t=0;t<this.enemyFlags.length;t++)this.enemyFlags[t]&&e++;return e},o.countPlayer=function(){for(var e=0,t=0;t<this.gridFlags.length;t++)this.gridFlags[t]&&e++;return e},o.searchEnemy=function(e){if(-1==this.enemySearches[e]){for(var t=Math.floor(e/y.MAP_W),n=e%y.MAP_W,i=0,r=-1;r<=1;r++)for(var o=-1;o<=1;o++){var a=n+r,s=t+o;if(a>=0&&a<=y.MAP_W-1&&s>=0&&s<=y.MAP_H-1){var l=a+s*y.MAP_W;this.enemyFlags[l]&&i++}}return this.enemySearches[e]=i,console.log("search at "+e+" count "+i),this.showSearchEffect(i),this.enemySearchCount=this.enemySearchCount+1,h.instance.showTip("侦察完毕！"),i}return console.log("has searched"),-1},o.selectEnemyGrid=function(e){null!=this.selectedEnemyGrid&&this.selectedEnemyGrid!=e&&(this.selectedEnemyGrid.getComponent(m).effectSelect(!1,!1),d.remote_select(this.selectedEnemyGrid.getComponent(m).getIndex(),!1)),null==e?(this.selectedEnemyGrid.getComponent(m).effectSelect(!1,!1),d.remote_select(this.selectedEnemyGrid.getComponent(m).getIndex(),!1)):(e.getComponent(m).effectSelect(!0,!1),d.remote_select(e.getComponent(m).getIndex(),!0)),this.selectedEnemyGrid=e},o.showTargetEffect=function(e){null!=this.selectedEnemyGrid&&(this.selectedEnemyGrid.getComponent(m).effectState(e,!1),d.remote_state(this.selectedEnemyGrid.getComponent(m).getIndex(),e)),this.selectEnemyGrid(null)},o.showSearchEffect=function(e){null!=this.selectedEnemyGrid&&(this.selectedEnemyGrid.getComponent(m).effectCount(e,!1),d.remote_count(this.selectedEnemyGrid.getComponent(m).getIndex(),e)),this.selectEnemyGrid(null)},o.remoteSelect=function(e,t){this.playerGrids[e].getComponent(m).effectSelect(t,!0)},o.remoteState=function(e,t){this.playerGrids[e].getComponent(m).effectState(t,!0)},o.remoteCount=function(e,t){this.playerGrids[e].getComponent(m).effectCount(t,!0)},o.collectShipInfo=function(){return this.shipInfo},t}(u)).instance=void 0,z=t((F=j).prototype,"playerGridsRoot",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=t(F.prototype,"enemyGridsRoot",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=t(F.prototype,"playerGrids",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_=t(F.prototype,"enemyGrids",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),k=t(F.prototype,"gridFlags",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),x=t(F.prototype,"enemyFlags",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),A=t(F.prototype,"gridStates",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),T=t(F.prototype,"enemyStates",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),R=t(F.prototype,"gridSearches",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),D=t(F.prototype,"enemySearches",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),U=t(F.prototype,"enemyEmptyCount",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),W=t(F.prototype,"enemyFiredCount",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),B=t(F.prototype,"enemySearchCount",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),L=t(F.prototype,"selectedEnemyGrid",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(F.prototype,"MarkRoot",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=F))||v));o._RF.pop()}}}));

System.register("chunks:///_virtual/MenuSceneManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,o,i,r,u,c,a,l;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){r=e.cclegacy,u=e._decorator,c=e.Node,a=e.director,l=e.Component}],execute:function(){var s,M,p,d,h,f,g;r._RF.push({},"bccf0CjbjRB7KJwmryNjmdL","MenuSceneManager",void 0);var S=u.ccclass,y=u.property;e("MenuSceneManager",(s=S("MenuSceneManager"),M=y(c),p=y(c),s((f=t((h=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),u=0;u<n;u++)r[u]=arguments[u];return t=e.call.apply(e,[this].concat(r))||this,o(t,"SingleModeButton",f,i(t)),o(t,"MultiModeButton",g,i(t)),t}n(t,e);var r=t.prototype;return r.start=function(){this.SingleModeButton.on(c.EventType.TOUCH_END,this.touchSingleModeButton,this),this.MultiModeButton.on(c.EventType.TOUCH_END,this.touchMultiModeButton,this)},r.touchSingleModeButton=function(e){a.loadScene("MenuScene")},r.touchMultiModeButton=function(e){a.loadScene("MultiWaitScene")},r.update=function(e){},t}(l)).prototype,"SingleModeButton",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=t(h.prototype,"MultiModeButton",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=h))||d));r._RF.pop()}}}));

System.register("chunks:///_virtual/MultiWaitSceneManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SocketManager.ts","./TipManager.ts"],(function(e){var t,n,i,o,a,r,l,u,c,s,b;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){a=e.cclegacy,r=e._decorator,l=e.Node,u=e.Label,c=e.Component},function(e){s=e.SocketManager},function(e){b=e.TipManager}],execute:function(){var g,h,p,d,f,C,m,y,v,M,B,w,D,L,S,T,z,_,P;a._RF.push({},"a9bcbR6cvhJ/7GmSEBRjf4n","MultiWaitSceneManager",void 0);var E=r.ccclass,I=r.property;e("MultiWaitSceneManager",(g=E("MultiWaitSceneManager"),h=I(l),p=I(u),d=I(u),f=I(u),C=I(l),m=I(l),y=I(l),v=I(Boolean),g((w=t((B=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return t=e.call.apply(e,[this].concat(a))||this,i(t,"ConfirmCodeButton",w,o(t)),i(t,"UIDLabel",D,o(t)),i(t,"CodeLabel",L,o(t)),i(t,"CodeShowLabel",S,o(t)),i(t,"CodePanel",T,o(t)),i(t,"DebugPlayerButton",z,o(t)),i(t,"DebugRoomButton",_,o(t)),i(t,"isMatching",P,o(t)),t}n(t,e);var a=t.prototype;return a.start=function(){this.ConfirmCodeButton.on(l.EventType.TOUCH_END,this.onTouchConfirmCodeButton,this),this.DebugPlayerButton.on(l.EventType.TOUCH_END,(function(e){s.send({action:"log_user"})}),this),this.DebugRoomButton.on(l.EventType.TOUCH_END,(function(e){s.send({action:"log_room"})}),this)},a.onTouchConfirmCodeButton=function(){if(this.isMatching){s.send({action:"quit_room"}),this.isMatching=!1,this.CodePanel.active=!0,this.CodeShowLabel.node.active=!1,this.ConfirmCodeButton.getComponentInChildren(u).string="匹配"}else{var e=this.CodeLabel.string;if(e.length<4)b.instance.showTip("不足4位数字");else{this.CodeShowLabel.string=e,console.log(e);var t={action:"match",code:e};s.send(t),this.isMatching=!0,this.CodePanel.active=!1,this.CodeShowLabel.node.active=!0,this.ConfirmCodeButton.getComponentInChildren(u).string="取消"}}},a.onLoad=function(){s.login()},a.update=function(){var e=localStorage.getItem("uid");null!=e&&(this.UIDLabel.string=e)},t}(c)).prototype,"ConfirmCodeButton",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=t(B.prototype,"UIDLabel",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=t(B.prototype,"CodeLabel",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=t(B.prototype,"CodeShowLabel",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=t(B.prototype,"CodePanel",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=t(B.prototype,"DebugPlayerButton",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=t(B.prototype,"DebugRoomButton",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=t(B.prototype,"isMatching",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),M=B))||M));a._RF.pop()}}}));

System.register("chunks:///_virtual/ShipBoxController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ShipManager.ts"],(function(e){var n,o,t,i,r,s,a,h,p,c,u,l,T;return{setters:[function(e){n=e.applyDecoratedDescriptor,o=e.inheritsLoose,t=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){r=e.cclegacy,s=e._decorator,a=e.Enum,h=e.Node,p=e.Sprite,c=e.Color,u=e.Component},function(e){l=e.ShipType,T=e.ShipManager}],execute:function(){var f,g,d,y,C,v,M;r._RF.push({},"5472cAdziJIiqwu/UNxFAs9","ShipBoxController",void 0);var S=s.ccclass,E=s.property;e("ShipBoxController",(f=S("ShipBoxController"),g=E({type:a(l)}),d=E(T),f((v=n((C=function(e){function n(){for(var n,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return n=e.call.apply(e,[this].concat(r))||this,t(n,"shipType",v,i(n)),t(n,"shipManager",M,i(n)),n.used=!1,n}o(n,e);var r=n.prototype;return r.start=function(){this.node.on(h.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(h.EventType.TOUCH_CANCEL,this.onTouchCancel,this),this.node.on(h.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(h.EventType.TOUCH_MOVE,this.onTouchMove,this)},r.onTouchStart=function(e){this.used||(this.shipManager.selectBox(this.shipType),this.shipManager.followFinger(e))},r.onTouchCancel=function(e){this.shipManager.releaseBox(!1,e.getUILocation())},r.onTouchEnd=function(e){this.shipManager.releaseBox(!0,e.getUILocation())},r.onTouchMove=function(e){this.used||this.shipManager.followFinger(e)},r.update=function(e){},r.use=function(){this.used=!0,this.node.getComponent(p).color=new c(128,128,128)},n}(u)).prototype,"shipType",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return l.Big}}),M=n(C.prototype,"shipManager",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=C))||y));r._RF.pop()}}}));

System.register("chunks:///_virtual/ShipController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ShipManager.ts","./GridController.ts","./MapManager.ts","./GameManager.ts"],(function(e){var n,i,t,o,a,r,s,p,l,c,h,u,g,f;return{setters:[function(e){n=e.applyDecoratedDescriptor,i=e.inheritsLoose,t=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){a=e.cclegacy,r=e._decorator,s=e.Node,p=e.Component},function(e){l=e.ShipShape,c=e.ShipType,h=e.ShipManager},function(e){u=e.GridController},function(e){g=e.MapManager},function(e){f=e.GameManager}],execute:function(){var d,b,M,m,y,C,S,v,T,w,B,k,z,_;a._RF.push({},"fc792RSoZBInZpIV2rtVMVA","ShipController",void 0);var E=r.ccclass,G=r.property;e("ShipController",(d=E("ShipController"),b=G(s),M=G(l),m=G(u),y=G(s),C=G(s),d((T=n((v=function(e){function n(){for(var n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return n=e.call.apply(e,[this].concat(a))||this,t(n,"shipBlocks",T,o(n)),t(n,"shape",w,o(n)),t(n,"index",B,o(n)),t(n,"bindedGrid",k,o(n)),t(n,"mapManager",z,o(n)),t(n,"shipManager",_,o(n)),n}i(n,e);var a=n.prototype;return a.start=function(){},a.update=function(e){},a.onLoad=function(){for(var e=this,n=0;n<this.shipBlocks.length;n++)this.shipBlocks[n].on(s.EventType.TOUCH_START,(function(n){e.onSelect(n)}),this),this.shipBlocks[n].on(s.EventType.TOUCH_MOVE,(function(n){e.onMove(n)}),this),this.shipBlocks[n].on(s.EventType.TOUCH_CANCEL,(function(n){e.onRelease(n)}),this),this.shipBlocks[n].on(s.EventType.TOUCH_END,(function(n){e.onRelease(n)}),this)},a.onSelect=function(e){f.instance.canInteract()&&(console.log("select Ship "+c[this.shape.shipType]+" in map"),this.shipManager.getComponent(h).currentShip=this.node,this.shipManager.getComponent(h).followFinger(e))},a.onMove=function(e){f.instance.canInteract()&&this.shipManager.getComponent(h).followFinger(e)},a.onRelease=function(e){f.instance.canInteract()&&(this.mapManager.getComponent(g).recordShapeCollision(this.index,this.shape,!1),this.shipManager.getComponent(h).releaseBox(!1,e.getUILocation(),!0))},a.initShape=function(e){this.shape=new l(e.shipType,e.shapes)},a.rotate=function(){this.node.angle=this.node.angle+90},a.backState=function(){this.mapManager.getComponent(g).recordShapeCollision(this.index,this.shape,!0),this.bindedGrid.bindShip(this.node)},n}(p)).prototype,"shipBlocks",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),w=n(v.prototype,"shape",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=n(v.prototype,"index",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),k=n(v.prototype,"bindedGrid",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=n(v.prototype,"mapManager",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=n(v.prototype,"shipManager",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=v))||S));a._RF.pop()}}}));

System.register("chunks:///_virtual/ShipManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MapManager.ts","./GridController.ts","./GameConfig.ts","./ShipController.ts","./ShipBoxController.ts","./GameManager.ts"],(function(e){var i,t,n,r,o,a,s,p,h,l,u,c,S,f,g,d,y,b,m,w,C;return{setters:[function(e){i=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,s=e.Enum,p=e.CCBoolean,h=e.Prefab,l=e.Node,u=e.Vec2,c=e.instantiate,S=e.UITransform,f=e.v3,g=e.Component},function(e){d=e.MapManager},function(e){y=e.GridController},function(e){b=e.GameConfig},function(e){m=e.ShipController},function(e){w=e.ShipBoxController},function(e){C=e.GameManager}],execute:function(){var M,v,x,B,T,z,P,R,_,A,G,O,F,I,U,k,D,H,L,W,j,E,N,Q,V,Z,q;o._RF.push({},"2781duQVnZDv7DMW1Fp1jwQ","ShipManager",void 0);var J=a.ccclass,K=a.property,X=e("ShipType",function(e){return e[e.Big=0]="Big",e[e.Middle=1]="Middle",e[e.Small=2]="Small",e[e.Tiny=3]="Tiny",e}({})),Y=e("ShipShape",(M=K({type:s(X)}),x=i((v=function(){function e(e,i){n(this,"shipType",x,this),n(this,"shapes",B,this),this.shipType=e,this.shapes=i}var i=e.prototype;return i.outOfBound=function(e){for(var i=Math.floor(e/b.MAP_W),t=e%b.MAP_H,n=0;n<this.shapes.length;n++){var r=t+this.shapes[n].x,o=i+this.shapes[n].y;if(r<0||r>b.MAP_W-1||o<0||o>b.MAP_H-1)return!0}return!1},i.getIndexes=function(e){for(var i=[],t=0;t<this.shapes.length;t++){var n=this.shapes[t];i.push(e+n.x+n.y*b.MAP_W)}return i},i.rotatedShape=function(){for(var i=[],t=0;t<this.shapes.length;t++){var n=this.shapes[t];i[t]=new u(-n.y,n.x)}return new e(this.shipType,i)},e}()).prototype,"shipType",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return X.Big}}),B=i(v.prototype,"shapes",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),v));e("ShipManager",(T=J("ShipManager"),z=K({type:d}),P=K({type:Y}),R=K({type:p}),_=K(h),A=K(l),G=K(l),O=K(l),F=K(l),I=K([p]),U=K([l]),T((H=i((D=function(e){function i(){for(var i,t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return i=e.call.apply(e,[this].concat(o))||this,n(i,"mapManager",H,r(i)),n(i,"shipShapes",L,r(i)),n(i,"boxSelecting",W,r(i)),n(i,"shipPreafabs",j,r(i)),n(i,"currentShip",E,r(i)),n(i,"focusedShip",N,r(i)),n(i,"currentShipRoot",Q,r(i)),n(i,"RotateShipButton",V,r(i)),n(i,"ShipUsedFlags",Z,r(i)),n(i,"ShipBoxes",q,r(i)),i}t(i,e);var o=i.prototype;return o.selectBox=function(e){if(C.instance.canInteract()&&(console.log("select Box "+X[e]),this.boxSelecting=!0,null==this.currentShip)){var i=c(this.shipPreafabs[e]);i.parent=this.currentShipRoot;var t=i.getComponent(m);t.initShape(this.shipShapes[e]),t.shipManager=this.node,t.mapManager=this.mapManager.node,this.currentShip=i}},o.releaseBox=function(e,i,t){var n;if(void 0===t&&(t=!1),C.instance.canInteract()){var r=null==(n=this.currentShip)?void 0:n.getComponent(m).shape.shipType;if(console.log("release "+X[r]),this.boxSelecting=!1,e)this.destroyCurrentShip();else{var o=this.mapManager.checkPos(i),a=t?this.currentShip.getComponent(m).shape:this.shipShapes[r];if(console.log("in grid "+o),-1!=o)if(a.outOfBound(o))this.destroyOrCanceledShip(t),console.log(a.shipType+" out of bound!");else if(this.mapManager.checkShapeCollision(o,a))this.destroyOrCanceledShip(t),console.log(a.shipType+" has collision with map!");else{var s=this.mapManager.playerGrids[o].getComponent(y);s.bindShip(this.currentShip),this.currentShip.getComponent(m).bindedGrid=s,this.currentShip.getComponent(m).index=o,this.mapManager.recordShapeCollision(o,a),this.focusedShip=this.currentShip,this.currentShip=null,t||this.useShipBox(r)}else this.destroyOrCanceledShip(t)}}},o.destroyOrCanceledShip=function(e){var i;e?(null==(i=this.currentShip)||i.getComponent(m).backState(),this.currentShip=null):this.destroyCurrentShip()},o.destroyCurrentShip=function(){var e;null==(e=this.currentShip)||e.destroy(),this.currentShip=null},o.onLoad=function(){this.shipShapes=[new Y(X.Big,[new u(-1,0),new u(0,0),new u(1,0),new u(-1,1),new u(0,1),new u(1,1)]),new Y(X.Middle,[new u(-1,0),new u(0,0),new u(1,0),new u(2,0)]),new Y(X.Small,[new u(-1,0),new u(0,0),new u(1,0)]),new Y(X.Tiny,[new u(0,0),new u(1,0)])],this.RotateShipButton.on(l.EventType.TOUCH_START,this.rotateShip,this)},o.followFinger=function(e){var i=e.getUILocation();if(this.currentShip){var t=this.currentShip.parent.getComponent(S).convertToNodeSpaceAR(f(i.x,i.y,0));this.currentShip.setPosition(t)}},o.rotateShip=function(e){if(!C.instance.isPrepared&&this.focusedShip){var i=this.focusedShip.getComponent(m),t=i.shape,n=i.index,r=t.rotatedShape();if(r.outOfBound(n))return;if(this.mapManager.recordShapeCollision(n,t,!1),this.mapManager.checkShapeCollision(n,r))return void this.mapManager.recordShapeCollision(n,t);this.mapManager.recordShapeCollision(n,r),i.initShape(r),i.rotate()}},o.useShipBox=function(e){this.ShipUsedFlags[e]=!1,this.ShipBoxes[e].getComponent(w).use()},i}(g)).prototype,"mapManager",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=i(D.prototype,"shipShapes",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),W=i(D.prototype,"boxSelecting",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),j=i(D.prototype,"shipPreafabs",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),E=i(D.prototype,"currentShip",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=i(D.prototype,"focusedShip",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=i(D.prototype,"currentShipRoot",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=i(D.prototype,"RotateShipButton",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z=i(D.prototype,"ShipUsedFlags",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[!1,!1,!1,!1]}}),q=i(D.prototype,"ShipBoxes",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),k=D))||k));o._RF.pop()}}}));

System.register("chunks:///_virtual/SocketManager.ts",["cc","./GameConfig.ts","./GameManager.ts","./MapManager.ts"],(function(e){var n,t,o,c,a;return{setters:[function(e){n=e.cclegacy,t=e.director},function(e){o=e.GameConfig},function(e){c=e.GameManager},function(e){a=e.MapManager}],execute:function(){n._RF.push({},"ee491x6415K25GJLXy9q38d","SocketManager",void 0),e("SocketManager",function(){function e(){}return e.login=function(){return null==this.socket&&(this.socket=new WebSocket(o.URL),this.socket.onopen=this._onopen,this.socket.onmessage=this._onmessage,this.socket.onclose=this._onclose,this.socket.onerror=this._onerror,!0)},e.send=function(n){var t=localStorage.getItem("uid");n.uid=t;var o=JSON.stringify(n);null!=e.socket?(e.socket.send(o),console.log("send : "+o)):console.log("socket is null")},e._onopen=function(n){e.send({action:"login"})},e._onmessage=function(n){console.log("recv : "+n.data),e.parse(n.data)},e._onclose=function(){console.log("close")},e._onerror=function(){console.log("error")},e.parse=function(n){var o=JSON.parse(n);switch(o.action){case"get_uid":e.op_get_uid(o);break;case"role":e.op_hole(o);break;case"prepare":t.loadScene("MultiGameScene");break;case"start":c.instance.startGame(o);break;case"quit":t.loadScene("MultiWaitScene");break;default:e["op_"+o.action](o)}},e.op_get_uid=function(e){var n=e.data;null!=n&&(console.log("set uid "+n),localStorage.setItem("uid",n))},e.op_hole=function(e){var n=e.holder;o.isHolder=n},e.op_remote_select=function(e){var n=e.index,t=e.flag;a.instance.remoteSelect(n,t)},e.op_remote_state=function(e){var n=e.index,t=e.state;a.instance.remoteState(n,t)},e.op_remote_count=function(e){var n=e.index,t=e.count;a.instance.remoteCount(n,t)},e.op_remote_win=function(e){c.instance.Lose()},e.op_remote_turn=function(e){c.instance.RecoverTurn()},e.remote_select=function(n,t){var o={action:"remote_select",index:n,flag:t};e.send(o)},e.remote_state=function(n,t){var o={action:"remote_state",index:n,state:t};e.send(o)},e.remote_count=function(n,t){var o={action:"remote_count",index:n,count:t};e.send(o)},e.remote_turn=function(){e.send({action:"remote_turn"})},e}()).socket=void 0,n._RF.pop()}}}));

System.register("chunks:///_virtual/TestDrag.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var o,n,e,i,s,r,c,a,u,h,l,T,p;return{setters:[function(t){o=t.applyDecoratedDescriptor,n=t.inheritsLoose,e=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){s=t.cclegacy,r=t._decorator,c=t.Node,a=t.input,u=t.Input,h=t.tween,l=t.v3,T=t.UITransform,p=t.Component}],execute:function(){var v,y,d,f,g;s._RF.push({},"0c2f3WsjZ1NbbTzWJMWOFD8","TestDrag",void 0);var D=r.ccclass,_=r.property;t("TestDrag",(v=D("TestDrag"),y=_(c),v((g=o((f=function(t){function o(){for(var o,n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return o=t.call.apply(t,[this].concat(s))||this,e(o,"button",g,i(o)),o}n(o,t);var s=o.prototype;return s.start=function(){var t=this;this.node.on(c.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(c.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(c.EventType.TOUCH_END,this.onTouchRelease,this),this.node.on(c.EventType.TOUCH_START,this.onTouchRelease,this),a.on(u.EventType.KEY_DOWN,this.onKeyDown,this),this.button.on(c.EventType.TOUCH_START,(function(o){h(t.node).to(1,{position:l(0,200,0)}).start()}),this)},s.onTouchStart=function(t){var o=t.getUILocation();console.log("onTouchStart "+o);var n=this.node.getComponent(T),e=null==n?void 0:n.convertToNodeSpaceAR(l(o.x,o.y,0));console.log(e)},s.onTouchMove=function(t){var o=t.getUIDelta(),n=o.x,e=o.y,i=this.node.position.x,s=this.node.position.y;this.node.setPosition(i+n,s+e)},s.onTouchRelease=function(t){},s.onKeyDown=function(t){console.log(t)},s.update=function(t){},o}(p)).prototype,"button",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=f))||d));s._RF.pop()}}}));

System.register("chunks:///_virtual/TipController.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,r,n,o,i,l,s,a,c,p;return{setters:[function(t){e=t.applyDecoratedDescriptor,r=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){i=t.cclegacy,l=t._decorator,s=t.Label,a=t.tween,c=t.v3,p=t.Component}],execute:function(){var u,f,h,y,v;i._RF.push({},"27ef6WASVNLsbqNngcqZFrZ","TipController",void 0);var d=l.ccclass,g=l.property;t("TipController",(u=d("TipController"),f=g(s),u((v=e((y=function(t){function e(){for(var e,r=arguments.length,i=new Array(r),l=0;l<r;l++)i[l]=arguments[l];return e=t.call.apply(t,[this].concat(i))||this,n(e,"text",v,o(e)),e}r(e,t);var i=e.prototype;return i.setText=function(t){this.text.string=t},i.start=function(){var t=this;a(this.node).to(1,{position:c(0,-100,0)}).call((function(){t.node.destroy()})).start()},e}(p)).prototype,"text",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=y))||h));i._RF.pop()}}}));

System.register("chunks:///_virtual/TipManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./TipController.ts"],(function(e){var t,i,n,r,o,a,p,c,l,s,u;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,p=e.Prefab,c=e.Node,l=e.instantiate,s=e.Component},function(e){u=e.TipController}],execute:function(){var f,T,b,g,h,y,v,d;o._RF.push({},"803a6FoxX1GJIO3VHDewc8o","TipManager",void 0);var P=a.ccclass,m=a.property;e("TipManager",(f=P("TipManager"),T=m(p),b=m(c),f(((d=function(e){function t(){for(var t,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,n(t,"TipPrefab",y,r(t)),n(t,"TipRoot",v,r(t)),t}i(t,e);var o=t.prototype;return o.onLoad=function(){t.instance=this},o.showTip=function(e){var t=l(this.TipPrefab);t.parent=this.TipRoot,t.getComponent(u).setText(e)},o.start=function(){},t}(s)).instance=void 0,y=t((h=d).prototype,"TipPrefab",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=t(h.prototype,"TipRoot",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=h))||g));o._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});